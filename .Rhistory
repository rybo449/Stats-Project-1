getwd()
setwd("home/rybo/Desktop/Stats-Project-1")
birthwt<-read.csv(file="birthwt.csv",head = TRUE)
colMeans(birthwt)
##Checking for NA values and removing them from the data
mothagena<-is.na(birthwt$MOTHAGE)
mothage<-birthwt$MOTHAGE[!mothagena]
new_data<-subset(birthwt, !mothagena)
premna<-is.na(birthwt$PREM)
new_data<-subset(new_data, !premna)
new_data<-subset(new_data, (new_data$BIRTHWT>0))
colMeans(new_data)
##Checking the statistics for mother's age
mean(new_data$MOTHAGE)
summary(new_data$MOTHAGE)
sd(new_data$MOTHAGE)
##Doing the same for mother's weight
mean(new_data$MOTHWT)
sd(new_data$MOTHWT)
summary(new_data$MOTHWT)
##Plotting mother's age with mother's weight
plot(new_data$BIRTHWT, new_data$MOTHAGE)
reg1<-lm(new_data$MOTHAGE~new_data$BIRTHWT)
abline(reg1)
##changing column names
mothage<-new_data$MOTHAGE
mothwt<-new_data$MOTHWT
race<-new_data$RACE
smoke<-new_data$SMOKE
prem<-new_data$PREM
hyper<-new_data$HYPER
urinirr<-new_data$URINIRR
physvis<-new_data$PHYSVIS
birthwt<-new_data$BIRTHWT
##Making sample histograms
hist(race)
hist(smoke)
hist(prem)
hist(urinirr)
hist(physvis)
plot(smoke, birthwt)
### Sample two tailed hypothesis testing
xbar = mean(birthwt)
mu0 = median(birthwt)
sigma = sd(birthwt)
n = length(birthwt)
z = (xbar-mu0)/(sigma/sqrt(n))
z
alpha = 0.05
z.half.alpha = qnorm(1-alpha/2)
c(-z.half.alpha,z.half.alpha)
##We notice that the value of z is -0.609, which is in between the 95% confidence interval of -1.95 and +1.95 so we do not
##reject the null hypothesis
reg1<-lm(birthwt~new_data$BIRTHWT)
c(-z.half.alpha,z.half.alpha)
z
getwd()
birthwt<-read.csv(file="birthwt.csv",head = TRUE)
colMeans(birthwt)
##Checking for NA values and removing them from the data
mothagena<-is.na(birthwt$MOTHAGE)
mothage<-birthwt$MOTHAGE[!mothagena]
new_data<-subset(birthwt, !mothagena)
premna<-is.na(birthwt$PREM)
new_data<-subset(new_data, !premna)
new_data<-subset(new_data, (new_data$BIRTHWT>0))
colMeans(new_data)
##Checking the statistics for mother's age
mean(new_data$MOTHAGE)
summary(new_data$MOTHAGE)
sd(new_data$MOTHAGE)
##Doing the same for mother's weight
mean(new_data$MOTHWT)
sd(new_data$MOTHWT)
summary(new_data$MOTHWT)
##Plotting mother's age with mother's weight
plot(new_data$BIRTHWT, new_data$MOTHAGE)
reg1<-lm(new_data$MOTHAGE~new_data$BIRTHWT)
abline(reg1)
##changing column names
mothage<-new_data$MOTHAGE
mothwt<-new_data$MOTHWT
race<-new_data$RACE
smoke<-new_data$SMOKE
prem<-new_data$PREM
hyper<-new_data$HYPER
urinirr<-new_data$URINIRR
physvis<-new_data$PHYSVIS
birthwt<-new_data$BIRTHWT
##Making sample histograms
hist(race)
hist(smoke)
hist(prem)
hist(urinirr)
hist(physvis)
plot(smoke, birthwt)
### Sample two tailed hypothesis testing
##check if sample mean of smokers is different from the sample mean of non smokers
xbar = mean(birthwt)
mu0 = median(birthwt)
sigma = sd(birthwt)
n = length(birthwt)
z = (xbar-mu0)/(sigma/sqrt(n))
z
alpha = 0.05
z.half.alpha = qnorm(1-alpha/2)
c(-z.half.alpha,z.half.alpha)
##We notice that the value of z is -0.609, which is in between the 95% confidence interval of -1.95 and +1.95 so we do not
##reject the null hypothesis
reg1<-lm(birthwt~new_data$BIRTHWT)
##Linear Model
fit<-lm(birthwt~mothage+mothwt+factor(race)+factor(smoke)+factor(hyper)+factor(urinirr)+factor(prem)+factor(physvis))
summary(fit)
plot(prem,birthwt)
abline(fit)
pairs(new_data)
library(leaps)
model<-leaps(x = new_data[,1:8], y = new_data[,9], names = names(new_data)[1:8], method = "Cp")
model<-update(fit, .~. - mothwt)
extractAIC(model, k = log(n))
library(MASS)
model1<-stepAIC(model, direction = "both")
AIC(model)
BIC(model)
model1
AIC(model1)
BIC(model1)
model<-update(fit, .~. - mothwt)
extractAIC(model, k = log(n))
library(MASS)
model1<-stepAIC(model, direction = "both")
AIC(model1)
BIC(model1)
mode<-lm(.~. - mothwt)
mode<-lm(.~. - mothwt, data = new_data)
mode<-lm(birthwt~. - mothwt, data = new_data)
mode<-lm(birthwt~. , data = new_data)
model<-lm(birthwt~. , data = new_data)
AIC(model)
BIC(model)
model1<-stepAIC(model, direction = "both")
fit<-lm(birthwt~mothage+mothwt+factor(race)+factor(smoke)+factor(hyper)+factor(urinirr)+factor(prem)+factor(physvis))
model1<-stepAIC(fit, direction = "both")
AIC(model)
BIC(model)
model1<-stepAIC(fit, direction = "both")
AIC(model1)
BIC(model1)
model1<-stepBIC(fit, direction = "both")
model1<-stepAIC(fit, direction = "both")
fit<-lm(birthwt~. + smoke*(. - smoke), data = new_data)
model1<-stepAIC(fit, direction = "both")
mothage<-new_data$MOTHAGE
mothwt<-new_data$MOTHWT
race<-factor(new_data$RACE)
smoke<-factor(new_data$SMOKE)
prem<-factor(new_data$PREM)
hyper<-factor(new_data$HYPER)
urinirr<-factor(new_data$URINIRR)
physvis<-factor(new_data$PHYSVIS)
birthwt<-new_data$BIRTHWT
fit<-lm(birthwt~. + smoke*(. - smoke), data = new_data)
model1<-stepAIC(fit, direction = "both")
fit<-lm(birthwt~. + smoke*(.-smoke), data = new_data)
model1<-stepAIC(fit, direction = "both")
fit<-lm(birthwt~ . + smoke*(.-smoke), data = new_data)
model1<-stepAIC(fit, direction = "both")
which(race == 0)
which(race == "0")
which(length(race == "0"))
length(which(race == "0"))
length(which(race ==0))
length(which(race ==1))
length(which(race ==0))
length(which(new_data$RACE ==0))
length(which(new_data$RACE ==1))
length(which(new_data$PREM ==1))
length(which(new_data$PREM ==0))
length(which(new_data$HYPER ==0))
length(which(new_data$HYPER ==1))
length(which(new_data$URINIRR ==1))
length(which(new_data$URINIRR ==0))
length(which(new_data$PHYSVIS ==0))
length(which(new_data$PHYSVIS ==1))
length(which(new_data$PHYSVIS ==2))
length(which(new_data$PHYSVIS ==3))
length(which(new_data$PHYSVIS ==4))
length(which(new_data$PHYSVIS ==5))
length(which(new_data$PHYSVIS ==6))
length(which(new_data$PHYSVIS ==7))
length(which(new_data$PHYSVIS ==8))
length(which(new_data$SMOKE==0))
length(which(new_data$SMOKE==1))
length(which(new_data$RACE==2))
length(which(new_data$RACE==3))
length(which(new_data$RACE==4))
length(which(new_data$RACE==5))
length(which(new_data$RACE==1))
length(which(new_data$RACE==2))
length(which(new_data$RACE==3))
length(which(new_data$RACE==4))
length(which(new_data$SMOKE==0))
length(which(new_data$SMOKE==1))
length(which(new_data$PREM==1))
length(which(new_data$PREM==0))
length(which(new_data$PREM==1))
length(which(new_data$HYPER==0))
length(which(new_data$HYPER==1))
length(which(new_data$URINIRR==0))
length(which(new_data$URINIRR==1))
length(which(new_data$PHYSVIS==0))
length(which(new_data$PHYSVIS==1))
length(which(new_data$PHYSVIS==2))
length(which(new_data$PHYSVIS==3))
length(which(new_data$PHYSVIS==4))
length(which(new_data$PHYSVIS==5))
length(which(new_data$PHYSVIS==6))
length(which(new_data$PHYSVIS==7))
p1<-a/(a+b+c)
a<-length(which(new_data$RACE==1))
b<-length(which(new_data$RACE==2))
c<-length(which(new_data$RACE==3))
p1<-a/(a+b+c)
p1
p2<-b/(a+b+c)
p3<-c/(a+b+c)
p1<-a/(a+b)
p2<-b/(a+b)
p1<-a/(a+b)
a<-length(which(new_data$RACE==1))
b<-length(which(new_data$RACE==2))
c<-length(which(new_data$RACE==3))
-a/(a+b+c)
b/(a+b+c)
a<-length(which(new_data$RACE==1))
b<-length(which(new_data$RACE==2))
c<-length(which(new_data$RACE==3))
a/(a+b+c)
b/(a+b+c)
c/(a+b+c)
a<-length(which(new_data$SMOKE==0))
b<-length(which(new_data$SMOKE==1))
a/(a+b)
b/(a+b)
a<-length(which(new_data$PREM==0))
b<-length(which(new_data$PREM==1))
a/(a+b)
b/(a+b)
a<-length(which(new_data$HYPER==0))
b<-length(which(new_data$HYPER==1))
a/(a+b)
b/(a+b)
a<-length(which(new_data$URINIRR==0))
b<-length(which(new_data$URINIRR==1))
a/(a+b)
b/(a+b)
a<-length(which(new_data$PHYSVIS==0))
b<-length(which(new_data$PHYSVIS==1))
c<-length(which(new_data$PHYSVIS==2))
d<-length(which(new_data$PHYSVIS==3))
e<-length(which(new_data$PHYSVIS==4))
f<-length(which(new_data$PHYSVIS==5))
g<-length(which(new_data$PHYSVIS==6))
a/(a+b+c+d+e+f+g)
b/(a+b+c+d+e+f+g)
c/(a+b+c+d+e+f+g)
d/(a+b+c+d+e+f+g)
e/(a+b+c+d+e+f+g)
f/(a+b+c+d+e+f+g)
g/(a+b+c+d+e+f+g)
a<-length(which(new_data$RACE==1))
a
b<-length(which(new_data$RACE==2))
b
c<-length(which(new_data$RACE==3))
c
a/(a+b+c)
b/(a+b+c)
c/(a+b+c)
a<-length(which(new_data$SMOKE==0))
a
b<-length(which(new_data$SMOKE==1))
b
a/(a+b)
b/(a+b)
a<-length(which(new_data$PREM==0))
a
b<-length(which(new_data$PREM==1))
b
a/(a+b)
b/(a+b)
a<-length(which(new_data$HYPER==0))
a
b<-length(which(new_data$HYPER==1))
b
a/(a+b)
b/(a+b)
a<-length(which(new_data$URINIRR==0))
a
b<-length(which(new_data$URINIRR==1))
b
a/(a+b)
b/(a+b)
a<-length(which(new_data$PHYSVIS==0))
a
b<-length(which(new_data$PHYSVIS==1))
b
c<-length(which(new_data$PHYSVIS==2))
c
d<-length(which(new_data$PHYSVIS==3))
d
e<-length(which(new_data$PHYSVIS==4))
e
f<-length(which(new_data$PHYSVIS==5))
f
g<-length(which(new_data$PHYSVIS==6))
g
a/(a+b+c+d+e+f+g)
b/(a+b+c+d+e+f+g)
c/(a+b+c+d+e+f+g)
d/(a+b+c+d+e+f+g)
e/(a+b+c+d+e+f+g)
f/(a+b+c+d+e+f+g)
g/(a+b+c+d+e+f+g)
mean(new_data$MOTHAGE)
summary(new_data$MOTHAGE)
sd(new_data$MOTHAGE)
mean(new_data$MOTHAGE)
sd(new_data$MOTHAGE)
median(new_data$MOTHAGE)
min(new_data$MOTHAGE)
max(new_data$MOTHAGE)
mean(new_data$MOTHWT)
sd(new_data$MOTHWT)
median(new_data$MOTHWT)
min(new_data$MOTHWT)
max(new_data$MOTHWT)
hist(birthwt)
plot(mothage, birthwt)
fit(birthwt~mothage)
abline(fit)
plot(mothwt, birthwt)
boxplot(race,birthwt)
boxplot(birthwt~race)
boxplot(birthwt~smoke)
boxplot(birthwt~prem)
boxplot(birthwt~hyper)
boxplot(birthwt~urinirr)
boxplot(birthwt~physvis)
par(mfrow=c(2,3))
boxplot(birthwt~race, xlab = "Race of the mother",ylab="Birth Weight of the Baby")
boxplot(birthwt~smoke, xlab = "Mother's Smoking Status duting pregnancy",ylab="Birth Weight of the Baby")
boxplot(birthwt~prem, xlab = "Mother's history of premature labour",ylab="Birth Weight of the Baby")
boxplot(birthwt~hyper, xlab = "Mther's history of Hypertension",ylab="Birth Weight of the Baby")
boxplot(birthwt~urinirr, xlab = "Mother's history of Urinary Irritation",ylab="Birth Weight of the Baby")
boxplot(birthwt~physvis, xlab = "Number of Physician Visits",ylab="Birth Weight of the Baby")
par(mfrow=c(1,2))
par(mfrow=c(1,2))
plot(mothage, birthwt, xlab="Mother's age during pregnancy", ylab="Birth Weight of the Baby")
plot(mothwt, birthwt, xlab="Mother's weight during pregnancy", ylab="Birth Weight of the Baby")
t.test(birthwt~smoke)
t.test(birthwt,smoke)
t.test(birthwt~smoke)
t.test(birthwt,smoke)
names(ttest)
ttest<-t.test(birthwt~smoke)
names(ttest)
ttest$statistic
ts = replicate(1000, t.test(birthwt~smoke)$statistic)
lines(density(ts))
pts = seq(-4.5,4.5,length=100)
plot(pts,dt(pts,df=18),col='red',type='1')
range(ts)
ts = replicate(1000, t.test(birthwt,smoke)$statistic)
smoke_0<-which(new_data$SMOKE==0)
smoke_0
fit.norm<-fitdist(smoke_0,"norm")
library(fitdistrplus)
install.packages("fitdistrplus")
smoke_0<-which(new_data$SMOKE==0)
smoke_1<-which(new_data$SMOKE==1)
fit.norm<-fitdist(smoke_0,"norm")
library(logspline)
smoke_0<-which(new_data$SMOKE==0)
smoke_1<-which(new_data$SMOKE==1)
fit.norm<-fitdist(smoke_0,"norm")
library(fitdistrplus)
library(logspline)
smoke_0<-which(new_data$SMOKE==0)
smoke_1<-which(new_data$SMOKE==1)
fit.norm<-fitdist(smoke_0,"norm")
plot(fit.norm)
smoke_0<-new_data$birthwt[new_data$SMOKE==0]
fit.norm<-fitdist(smoke_0,"norm")
smoke_0
smoke_0<-new_data$birthwt[which(new_data$SMOKE==0)]
smoke_0
smoke_0<-new_data$birthwt[,cols]
cols<-which(new_data$SMOKE==0)
smoke_0<-new_data$birthwt[,cols]
smoke_0
smoke_0<-birthwt[,cols]
smoke_0<-birthwt[cols]
smoke_0
fit.norm<-fitdist(smoke_0,"norm")
plot(fit.norm)
fit.weibull<-fitdist(smoke_0,"weibull")
plot(fit.weightbull)
plot(fit.weibull)
plot(fit.norm)
plot(fit.weibull)
plot(fit.norm)
plot(fit.weibull)
plot(fit.norm)
plot(fit.weibull)
plot(fit.norm)
plot(fit.weibull)
fit.poisson<-fitdist(smoke_0,"poisson")
length(smoke_0)
mean(fit.weibull)
mean(smoke_0)
sd(smoke_0)
dnorm(115, mean = 3054.957, sd = 752.409)
fit.weibull
fit.nrm
fit.norm
smoke_0<-birthwt[cols]
smoke_0
cols<-which(new_data$SMOKE==1)
smoke_1<-birthwt[cols]
fit.smoke_0<-fitdist(smoke_0,"norm")
plot(fit.smoke_0)
fit.smoke_1<-fitdist(smoke_1,"norm")
plot(fit.smoke_1)
t.test(smoke_0,smoke_1)
boxplot(smoke_0,smoke_1)
boxplot(smoke_0,smoke_1, ylab="Birth Weight of the Child", names=c("Non-Smokers","Non-Smokers"))
mean(smoke_0)
sd(smoke_0)
mean(smoke_1)
sd(smoke_1)
t.test(smoke_1,smoke_0)
t.test(smoke_1,smoke_0,mu=10)
t.test(smoke_1,smoke_0,mu=300)
t.test(smoke_1,smoke_0)
t.test(smoke_0,smoke_1)
boxplot(smoke_0,smoke_1, ylab="Birth Weight of the Child", names=c("Non-Smokers","Smokers"))
t.test(smoke_0,smoke_1,alternative="more")
t.test(smoke_0,smoke_1,alternative="greater")
t.test(smoke_0,smoke_1)
t.test(smoke_0,smoke_1,alternative="more")
t.test(smoke_0,smoke_1,alternative="greater")
t.test(smoke_0,smoke_0,alternative="greater")
t.test(smoke_0,smoke_0)
t.test(smoke_0,smoke_1)
t.test(smoke_0,smoke_1,alternative = "greater")
t.test(smoke_0,smoke_1,alternative = "less")
t.test(smoke_0,smoke_1,alternative = "greater")
fit.smoke_0<-fitdist(smoke_0,"norm")
plot(fit.smoke_0)
plot(fit.smoke_1)
res0 <- lm(BIRTHWT~MOTHAGE+MOTHWT+factor(RACE)+factor(SMOKE)+PREM+
factor(HYPER)+factor(URINIRR)+PHYSVIS, data=birth)
